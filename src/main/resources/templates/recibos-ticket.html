<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Recibos</title>
    <style>
        /* ==== Config ticket 58mm ==== */
        :root { --ticket-width: 68mm; } /* cambia a 80mm si usas rollo de 80 */
        @page { size: 68mm 200mm; margin: 0; }  /* prueba 200–250mm; ajusta a gusto */
        html, body { width: 68mm; margin: 0 auto; font-family: "Courier New", monospace; font-size: 12px; }

        .line { text-align:center; margin:6px 0; font-size:10px; }
        .line::before { content: "------------------------------------------"; white-space: pre; }

        .title   { font-weight:700; text-align:center; margin: 2px 0; }
        .subtitle{ text-align:center; margin: 0; font-size: 11px; }
        .logo    { display:block; margin:0 auto 6px; max-width: 48mm; }

        .ticket { page-break-inside: avoid; break-inside: avoid; padding: 8px; }
        .ticket + .ticket { margin-top: 6px; }  /* separador visual */

        /* Fuerza tamaño tipo ticketera (58 mm de ancho, alto “normalito”) */


        .lr { display:flex; justify-content:space-between; gap:8px; }
        .lr .right { text-align:right; min-width:60px; }

        .muted { font-size: 11px; }
        .bold  { font-weight: 700; }

        .doc-header, .doc-footer { padding: 8px; }
        .thanks { text-align:center; margin-top: 6px; font-size: 11px; }
    </style>
</head>
<body>

<!-- ===== HEADER ÚNICO ===== -->
<div class="doc-header">
    <!-- Logo opcional -->
    <img th:if="${logoPath}" th:src="${logoPath}" alt="logo" class="logo"/>
    <div class="title"    th:text="${avicolaNombre}">NOMBRE DE LA AVÍCOLA</div>
    <div class="subtitle">WHATSAPP: <span th:text="${whatsapp}">999999999</span></div>
    <div class="line"></div>
</div>
<div class="lr">
    <div>USUARIO</div>
    <div class="right" th:text="${usuarioId}">45</div>
</div>


<!-- ===== TICKETS (1 por pedido) ===== -->
<div th:each="p : ${pedidos}" class="ticket">


    <div class="line"></div>

    <div class="lr">
        <div th:if="${#temporals}" th:text="${#temporals.format(p.fechaCreacion, 'dd/MM/yyyy')}">dd/MM/yyyy</div>
    </div>

    <!-- Detalles -->
    <div th:if="${#lists.isEmpty(p.detalles)}" class="muted" style="text-align:center;">Sin detalles</div>
    <div th:each="d : ${p.detalles}">
        <div class="lr">
            <div>
                <span th:text="${d.cantidad}">3</span>
                <span> x </span>
                <span th:text="${#numbers.formatDecimal(d.precioXKilo,1,'POINT',2,'POINT')}">8.10</span>
                <span> - </span>
                <span th:text="${d.tipoAveNombre}">Pollo</span>
                <span> (</span><span th:text="${#numbers.formatDecimal(d.peso,1,'POINT',2,'POINT')}">12.40</span><span> kg)</span>
            </div>
            <div class="right" th:text="${'S/ ' + #numbers.formatDecimal(d.importeSubTotal,1,'POINT',2,'POINT')}">S/ 105.30</div>
        </div>
    </div>
    <!-- Totales -->
    <div class="lr bold">
        <div>A cuenta</div>
        <div class="right" th:text="${'S/ ' + #numbers.formatDecimal((p.totalPagado),1,'POINT',2,'POINT')}">S/ 0.00</div>
    </div>
    <div class="lr bold">
        <div>Total Saldo</div>
        <div class="right" th:text="${'S/ ' + #numbers.formatDecimal(p.totalSaldo,1,'POINT',2,'POINT')}">S/ 0.00</div>
    </div>


</div>

<!-- ===== FOOTER ÚNICO ===== -->
<div class="doc-footer">
    <div class="line"></div>
    <div class="thanks">¡Gracias por su preferencia!</div>
</div>

</body>
</html>

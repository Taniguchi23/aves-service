<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Recibos</title>
    <style>
        @page { margin: 0; }
        body { font-family: "Courier New", monospace; font-size: 12px; margin: 0; padding: 10px; }
        .enc { text-align: center; margin-bottom: 6px; }
        .title { font-weight: bold; }
        .sep { text-align: center; margin: 6px 0; font-size: 10px; }
        .sep:before { content: "------------------------------------------"; }
        .pedido { margin-bottom: 10px; page-break-inside: avoid; }
        .titulo { font-weight: bold; margin: 4px 0; }
        table.lines { width: 100%; border-collapse: collapse; }
        table.lines td { padding: 2px 0; vertical-align: top; }
        td.right { text-align: right; width: 1%; white-space: nowrap; }
        .totales { margin-top: 6px; }
        .muted { font-size: 11px; text-align: center; }
    </style>
</head>
<body>

<div class="enc">
    <div class="title" th:text="${avicolaNombre}">NOMBRE DE LA AV√çCOLA</div>
    <div>WHATSAPP: <span th:text="${whatsapp}">999999999</span></div>
    <div>ID USUARIO: <span th:text="${usuarioId}">0</span></div>
    <div class="sep"></div>
</div>

<!-- Mensaje si NO hay pedidos -->
<div class="muted" th:if="${!hayPedidos}">Sin deudas para mostrar.</div>

<!-- Lista de pedidos -->
<div th:each="p : ${pedidos}" class="pedido">

    <div class="titulo">
        Pedido <span th:text="${p.id}">0</span>| <span th:text="${#temporals.format(p.fechaCreacion, 'dd/MM/yyyy HH:mm')}">dd/MM/yyyy HH:mm</span>
        <!-- &#160;|&#160; <span th:text="${p.estado != null ? p.estado.nombre : '-'}">-</span>-->
    </div>

    <!-- Detalles -->
    <table class="lines" th:if="${p.detalles != null and !#lists.isEmpty(p.detalles)}">
        <tbody>

        <tr th:each="d : ${p.detalles}">
            <td>
                (<span th:text="${d.cantidad}">0</span>)
                <span th:text="${d.tipoAveNombre}">Producto</span>
                (S/ <span th:text="${#numbers.formatDecimal(d.precioXKilo,1,'POINT',2,'POINT')}">0.00</span>)
                x <span th:text="${#numbers.formatDecimal(d.peso,1,'POINT',2,'POINT')}">0.00</span> kg
            </td>
            <td class="right" th:text="${'S/ ' + #numbers.formatDecimal(d.importeSubTotal,1,'POINT',2,'POINT')}">S/ 0.00</td>
        </tr>
        </tbody>
    </table>

    <!-- Totales del pedido (A cuenta = pagos + desc.) -->
    <!--<div class="totales">
        <table class="lines">
            <tbody>
            <tr>
                <td>A cuenta</td>
                <td class="right"
                    th:text="${'S/ ' + #numbers.formatDecimal((p.totalPagado?:T(java.math.BigDecimal).ZERO).add(p.totalDescuento?:T(java.math.BigDecimal).ZERO),1,'POINT',2,'POINT')}">
                    S/ 0.00
                </td>
            </tr>
            <tr>
                <td>Saldo</td>
                <td class="right"
                    th:text="${'S/ ' + #numbers.formatDecimal(p.totalSaldo?:T(java.math.BigDecimal).ZERO,1,'POINT',2,'POINT')}">
                    S/ 0.00
                </td>
            </tr>
            </tbody>
        </table>
    </div> -->
</div>

<!-- Pie con totales globales (vienen por setVariable) -->
<div class="sep" th:if="${hayPedidos}"></div>
<table class="lines" th:if="${hayPedidos}">
    <tbody>
    <tr>
        <td class="title">TOTAL A CUENTA</td>
        <td class="right title" th:text="${'S/ ' + #numbers.formatDecimal(totalACuentaAll,1,'POINT',2,'POINT')}">S/ 0.00</td>
    </tr>
    <tr>
        <td class="title">TOTAL SALDO</td>
        <td class="right title" th:text="${'S/ ' + #numbers.formatDecimal(totalSaldoAll,1,'POINT',2,'POINT')}">S/ 0.00</td>
    </tr>
    </tbody>
</table>

</body>
</html>
